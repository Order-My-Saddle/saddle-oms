# GitLeaks Configuration for OMS Project
# Detects secrets, passwords, API keys, and sensitive data

title = "OMS GitLeaks Configuration"

[extend]
# Use the default GitLeaks rules
useDefault = true

[[rules]]
description = "Database connection strings"
id = "database-url"
regex = '''(?i)(database_url|connection_string|db_url)\s*[=:]\s*['"]\w+://[^\s'"]+['"']'''
tags = ["database", "url"]

[[rules]]
description = "JWT secrets and keys"
id = "jwt-secret"
regex = '''(?i)(jwt[_-]?secret|jwt[_-]?key|access[_-]?token[_-]?secret)\s*[=:]\s*['"]\S{20,}['"']'''
tags = ["jwt", "secret"]

[[rules]]
description = "API keys and tokens"
id = "api-key"
regex = '''(?i)(api[_-]?key|access[_-]?token|secret[_-]?key)\s*[=:]\s*['"]\S{20,}['"']'''
tags = ["api", "key"]

[[rules]]
description = "Database passwords"
id = "database-password"
regex = '''(?i)(password|passwd|pwd)\s*[=:]\s*['"]\S{8,}['"']'''
tags = ["password", "database"]

[[rules]]
description = "Private keys"
id = "private-key"
regex = '''-----BEGIN\s+(RSA\s+)?PRIVATE\s+KEY-----'''
tags = ["private", "key"]

[[rules]]
description = "Kubernetes config"
id = "kubeconfig"
regex = '''(?i)(kubeconfig|kube-config)'''
path = '''.*'''
tags = ["kubernetes", "config"]

[[rules]]
description = "Docker registry tokens"
id = "docker-token"
regex = '''(?i)(docker[_-]?token|registry[_-]?token)\s*[=:]\s*['"]\S{20,}['"']'''
tags = ["docker", "token"]

[[rules]]
description = "AWS credentials"
id = "aws-credentials"
regex = '''(?i)(aws[_-]?access[_-]?key|aws[_-]?secret)\s*[=:]\s*['"]\S{20,}['"']'''
tags = ["aws", "credentials"]

[[rules]]
description = "Generic secrets"
id = "generic-secret"
regex = '''(?i)(secret|token|key|password)\s*[=:]\s*['"]\S{32,}['"']'''
tags = ["generic", "secret"]

[allowlist]
description = "Allowlist for false positives"
regexes = [
    '''example\.com''',
    '''localhost''',
    '''127\.0\.0\.1''',
    '''test[_-]?password''',
    '''fake[_-]?key''',
    '''dummy[_-]?secret''',
    '''placeholder''',
    '''your[_-]?secret[_-]?here''',
    '''replace[_-]?me''',
]

paths = [
    '''.*\.md$''',
    '''.*\.txt$''',
    '''.*\.example$''',
    '''.*\.template$''',
    '''.*\.sample$''',
    '''node_modules/.*''',
    '''.git/.*''',
    '''docs/.*''',
    '''README.*''',
]