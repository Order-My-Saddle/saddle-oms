
> oms-nestjs-api@1.0.0 test
> jest

FAIL test/unit/options/option.service.spec.ts
  ‚óè Test suite failed to run

    [96mtest/unit/options/option.service.spec.ts[0m:[93m6[0m:[93m28[0m - [91merror[0m[90m TS2307: [0mCannot find module '../../../src/options/domain/value-objects/option-type.value-object' or its corresponding type declarations.

    [7m6[0m import { OptionType } from "../../../src/options/domain/value-objects/option-type.value-object";
    [7m [0m [91m                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m7[0m:[93m30[0m - [91merror[0m[90m TS2307: [0mCannot find module '../../../src/options/domain/value-objects/option-status.value-object' or its corresponding type declarations.

    [7m7[0m import { OptionStatus } from "../../../src/options/domain/value-objects/option-status.value-object";
    [7m [0m [91m                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m17[0m:[93m42[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ id: number; legacyId: number; name: string; description: string; type: number; group: string; isRequired: boolean; allowMultiple: boolean; sortOrder: number; priceModifier: number; status: string; ... 19 more ...; deletedAt: undefined; }' to type 'OptionEntity' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ id: number; legacyId: number; name: string; description: string; type: number; group: string; isRequired: boolean; allowMultiple: boolean; sortOrder: number; priceModifier: number; status: string; ... 19 more ...; deletedAt: undefined; }' is missing the following properties from type 'OptionEntity': isActive, getPriceForTier, getAllPrices

    [7m 17[0m   const mockOptionEntity: OptionEntity = {
    [7m   [0m [91m                                         ~[0m
    [7m 18[0m     id: 201,
    [7m   [0m [91m~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m 48[0m     deletedAt: undefined,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m 49[0m   } as OptionEntity;
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m55[0m:[93m5[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'description' does not exist in type 'Partial<OptionDto>'.

    [7m55[0m     description: "Adjustable stirrup leather length options",
    [7m  [0m [91m    ~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m98[0m:[93m18[0m - [91merror[0m[90m TS2339: [0mProperty 'createFindOptions' does not exist on type 'typeof OptionEntity'.

    [7m98[0m     OptionEntity.createFindOptions = jest.fn().mockImplementation((id) => {
    [7m  [0m [91m                 ~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m115[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'description' does not exist in type 'CreateOptionDto'.

    [7m115[0m         description: "Adjustable seat depth measurement",
    [7m   [0m [91m        ~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m153[0m:[93m41[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ id: number; legacyId: number; type: any; group: string; status: string; price1: number; price2: number; price3: number; price4: number; price5: number; price6: number; price7: number; priceContrast1: number; ... 12 more ...; name: string; }' to type 'OptionEntity' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ id: number; legacyId: number; type: any; group: string; status: string; price1: number; price2: number; price3: number; price4: number; price5: number; price6: number; price7: number; priceContrast1: number; ... 12 more ...; name: string; }' is missing the following properties from type 'OptionEntity': isActive, getPriceForTier, getAllPrices

    [7m153[0m       repository.create.mockReturnValue(newOptionEntity as OptionEntity);
    [7m   [0m [91m                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m154[0m:[93m41[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ id: number; legacyId: number; type: any; group: string; status: string; price1: number; price2: number; price3: number; price4: number; price5: number; price6: number; price7: number; priceContrast1: number; ... 12 more ...; name: string; }' to type 'OptionEntity' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ id: number; legacyId: number; type: any; group: string; status: string; price1: number; price2: number; price3: number; price4: number; price5: number; price6: number; price7: number; priceContrast1: number; ... 12 more ...; name: string; }' is missing the following properties from type 'OptionEntity': isActive, getPriceForTier, getAllPrices

    [7m154[0m       repository.save.mockResolvedValue(newOptionEntity as OptionEntity);
    [7m   [0m [91m                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m164[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'displayName' does not exist on type 'OptionDto'.

    [7m164[0m       expect(result.displayName).toBe(createDto.name);
    [7m   [0m [91m                    ~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m172[0m:[93m33[0m - [91merror[0m[90m TS2339: [0mProperty 'isRequired' does not exist on type 'CreateOptionDto'.

    [7m172[0m           isRequired: createDto.isRequired,
    [7m   [0m [91m                                ~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m173[0m:[93m36[0m - [91merror[0m[90m TS2339: [0mProperty 'allowMultiple' does not exist on type 'CreateOptionDto'.

    [7m173[0m           allowMultiple: createDto.allowMultiple,
    [7m   [0m [91m                                   ~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m174[0m:[93m32[0m - [91merror[0m[90m TS2339: [0mProperty 'sortOrder' does not exist on type 'CreateOptionDto'.

    [7m174[0m           sortOrder: createDto.sortOrder,
    [7m   [0m [91m                               ~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m175[0m:[93m36[0m - [91merror[0m[90m TS2339: [0mProperty 'priceModifier' does not exist on type 'CreateOptionDto'.

    [7m175[0m           priceModifier: createDto.priceModifier,
    [7m   [0m [91m                                   ~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m185[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'description' does not exist in type 'CreateOptionDto'.

    [7m185[0m         description: "Duplicate option",
    [7m   [0m [91m        ~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m193[0m:[93m9[0m - [91merror[0m[90m TS2304: [0mCannot find name 'ConflictException'.

    [7m193[0m         ConflictException,
    [7m   [0m [91m        ~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m206[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'description' does not exist in type 'CreateOptionDto'.

    [7m206[0m         description: "Basic option description",
    [7m   [0m [91m        ~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m239[0m:[93m41[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ type: number; isRequired: boolean; allowMultiple: boolean; sortOrder: number; priceModifier: number; group: string; status: string; price1: number; price2: number; price3: number; price4: number; ... 13 more ...; name: string; }' to type 'OptionEntity' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ type: number; isRequired: boolean; allowMultiple: boolean; sortOrder: number; priceModifier: number; group: string; status: string; price1: number; price2: number; price3: number; price4: number; ... 13 more ...; name: string; }' is missing the following properties from type 'OptionEntity': id, createdAt, updatedAt, isActive, and 2 more.

    [7m239[0m       repository.create.mockReturnValue(optionWithDefaults as OptionEntity);
    [7m   [0m [91m                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m240[0m:[93m41[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ type: number; isRequired: boolean; allowMultiple: boolean; sortOrder: number; priceModifier: number; group: string; status: string; price1: number; price2: number; price3: number; price4: number; ... 13 more ...; name: string; }' to type 'OptionEntity' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ type: number; isRequired: boolean; allowMultiple: boolean; sortOrder: number; priceModifier: number; group: string; status: string; price1: number; price2: number; price3: number; price4: number; ... 13 more ...; name: string; }' is missing the following properties from type 'OptionEntity': id, createdAt, updatedAt, isActive, and 2 more.

    [7m240[0m       repository.save.mockResolvedValue(optionWithDefaults as OptionEntity);
    [7m   [0m [91m                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m250[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'displayName' does not exist on type 'OptionDto'.

    [7m250[0m       expect(result.displayName).toBe(minimalDto.name);
    [7m   [0m [91m                    ~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m268[0m:[93m20[0m - [91merror[0m[90m TS2339: [0mProperty 'createFindOptions' does not exist on type 'typeof OptionEntity'.

    [7m268[0m       OptionEntity.createFindOptions = jest
    [7m   [0m [91m                   ~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m280[0m:[93m27[0m - [91merror[0m[90m TS2339: [0mProperty 'createFindOptions' does not exist on type 'typeof OptionEntity'.

    [7m280[0m       expect(OptionEntity.createFindOptions).toHaveBeenCalledWith(optionId);
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m290[0m:[93m20[0m - [91merror[0m[90m TS2339: [0mProperty 'createFindOptions' does not exist on type 'typeof OptionEntity'.

    [7m290[0m       OptionEntity.createFindOptions = jest.fn().mockReturnValue({ legacyId });
    [7m   [0m [91m                   ~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m300[0m:[93m27[0m - [91merror[0m[90m TS2339: [0mProperty 'createFindOptions' does not exist on type 'typeof OptionEntity'.

    [7m300[0m       expect(OptionEntity.createFindOptions).toHaveBeenCalledWith(legacyId);
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m310[0m:[93m20[0m - [91merror[0m[90m TS2339: [0mProperty 'createFindOptions' does not exist on type 'typeof OptionEntity'.

    [7m310[0m       OptionEntity.createFindOptions = jest
    [7m   [0m [91m                   ~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m387[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'description' does not exist in type 'UpdateOptionDto'.

    [7m387[0m         description: "Updated description",
    [7m   [0m [91m        ~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m450[0m:[93m44[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'description' does not exist in type 'UpdateOptionDto'.

    [7m450[0m       const updateDto: UpdateOptionDto = { description: "New description" };
    [7m   [0m [91m                                           ~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m466[0m:[93m41[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ deleted: boolean; deletedAt: Date; id: number; name: string; group?: string; type: number; price1: number; price2: number; price3: number; price4: number; price5: number; price6: number; ... 11 more ...; updatedAt: Date; }' to type 'OptionEntity' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ deleted: boolean; deletedAt: Date; id: number; name: string; group?: string | undefined; type: number; price1: number; price2: number; price3: number; price4: number; price5: number; price6: number; ... 11 more ...; updatedAt: Date; }' is missing the following properties from type 'OptionEntity': isActive, getPriceForTier, getAllPrices

    [7m466[0m       repository.save.mockResolvedValue({
    [7m   [0m [91m                                        ~[0m
    [7m467[0m         ...mockOptionEntity,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m469[0m         deletedAt: new Date(),
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m470[0m       } as OptionEntity);
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m488[0m:[93m41[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ deleted: boolean; deletedAt: Date; id: number; name: string; group?: string; type: number; price1: number; price2: number; price3: number; price4: number; price5: number; price6: number; ... 11 more ...; updatedAt: Date; }' to type 'OptionEntity' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ deleted: boolean; deletedAt: Date; id: number; name: string; group?: string | undefined; type: number; price1: number; price2: number; price3: number; price4: number; price5: number; price6: number; ... 11 more ...; updatedAt: Date; }' is missing the following properties from type 'OptionEntity': isActive, getPriceForTier, getAllPrices

    [7m488[0m       repository.save.mockResolvedValue({
    [7m   [0m [91m                                        ~[0m
    [7m489[0m         ...mockOptionEntity,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m491[0m         deletedAt: new Date(),
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m492[0m       } as OptionEntity);
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/options/option.service.spec.ts[0m:[93m493[0m:[93m20[0m - [91merror[0m[90m TS2339: [0mProperty 'createFindOptions' does not exist on type 'typeof OptionEntity'.

    [7m493[0m       OptionEntity.createFindOptions = jest.fn().mockReturnValue({ legacyId });
    [7m   [0m [91m                   ~~~~~~~~~~~~~~~~~[0m

FAIL test/unit/customers/customer.service.spec.ts
  ‚óè Test suite failed to run

    [96mtest/unit/customers/customer.service.spec.ts[0m:[93m316[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'null' is not assignable to type 'number | undefined'.

    [7m316[0m         fitterId: null,
    [7m   [0m [91m        ~~~~~~~~[0m

      [96msrc/customers/dto/create-customer.dto.ts[0m:[93m126[0m:[93m3[0m
        [7m126[0m   fitterId?: number;
        [7m   [0m [96m  ~~~~~~~~[0m
        The expected type comes from property 'fitterId' which is declared here on type 'UpdateCustomerDto'

FAIL test/unit/orders/order.controller.spec.ts
  ‚óè Test suite failed to run

    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m16[0m:[93m5[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m16[0m     id: "550e8400-e29b-41d4-a716-446655440000",
    [7m  [0m [91m    ~~[0m

      [96msrc/orders/dto/order.dto.ts[0m:[93m13[0m:[93m3[0m
        [7m13[0m   id: number;
        [7m  [0m [96m  ~~[0m
        The expected type comes from property 'id' which is declared here on type 'OrderDto'
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m18[0m:[93m5[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m18[0m     customerId: "123e4567-e89b-12d3-a456-426614174000",
    [7m  [0m [91m    ~~~~~~~~~~[0m

      [96msrc/orders/dto/order.dto.ts[0m:[93m19[0m:[93m3[0m
        [7m19[0m   customerId: number;
        [7m  [0m [96m  ~~~~~~~~~~[0m
        The expected type comes from property 'customerId' which is declared here on type 'OrderDto'
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m19[0m:[93m5[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m19[0m     fitterId: "789e0123-e45b-67c8-d901-234567890abc",
    [7m  [0m [91m    ~~~~~~~~[0m

      [96msrc/orders/dto/order.dto.ts[0m:[93m56[0m:[93m3[0m
        [7m56[0m   fitterId: number | null;
        [7m  [0m [96m  ~~~~~~~~[0m
        The expected type comes from property 'fitterId' which is declared here on type 'OrderDto'
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m20[0m:[93m5[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m20[0m     factoryId: "456e7890-b12c-34d5-e678-901234567def",
    [7m  [0m [91m    ~~~~~~~~~[0m

      [96msrc/orders/dto/order.dto.ts[0m:[93m63[0m:[93m3[0m
        [7m63[0m   factoryId: number | null;
        [7m  [0m [96m  ~~~~~~~~~[0m
        The expected type comes from property 'factoryId' which is declared here on type 'OrderDto'
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m45[0m:[93m5[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m45[0m     saddleId: "saddle-123",
    [7m  [0m [91m    ~~~~~~~~[0m

      [96msrc/orders/dto/order.dto.ts[0m:[93m155[0m:[93m3[0m
        [7m155[0m   saddleId: number | null;
        [7m   [0m [96m  ~~~~~~~~[0m
        The expected type comes from property 'saddleId' which is declared here on type 'OrderDto'
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m118[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m118[0m         customerId: "123e4567-e89b-12d3-a456-426614174000",
    [7m   [0m [91m        ~~~~~~~~~~[0m

      [96msrc/orders/dto/create-order.dto.ts[0m:[93m57[0m:[93m3[0m
        [7m57[0m   customerId?: number;
        [7m  [0m [96m  ~~~~~~~~~~[0m
        The expected type comes from property 'customerId' which is declared here on type 'CreateOrderDto'
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m128[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m128[0m         fitterId: "789e0123-e45b-67c8-d901-234567890abc",
    [7m   [0m [91m        ~~~~~~~~[0m

      [96msrc/orders/dto/create-order.dto.ts[0m:[93m25[0m:[93m3[0m
        [7m25[0m   fitterId?: number;
        [7m  [0m [96m  ~~~~~~~~[0m
        The expected type comes from property 'fitterId' which is declared here on type 'CreateOrderDto'
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m129[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m129[0m         factoryId: "456e7890-b12c-34d5-e678-901234567def",
    [7m   [0m [91m        ~~~~~~~~~[0m

      [96msrc/orders/dto/create-order.dto.ts[0m:[93m49[0m:[93m3[0m
        [7m49[0m   factoryId?: number;
        [7m  [0m [96m  ~~~~~~~~~[0m
        The expected type comes from property 'factoryId' which is declared here on type 'CreateOrderDto'
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m152[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m152[0m         customerId: "123e4567-e89b-12d3-a456-426614174000",
    [7m   [0m [91m        ~~~~~~~~~~[0m

      [96msrc/orders/dto/create-order.dto.ts[0m:[93m57[0m:[93m3[0m
        [7m57[0m   customerId?: number;
        [7m  [0m [96m  ~~~~~~~~~~[0m
        The expected type comes from property 'customerId' which is declared here on type 'CreateOrderDto'
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m182[0m:[93m46[0m - [91merror[0m[90m TS2345: [0mArgument of type 'OrderDto[]' is not assignable to parameter of type '{ data: OrderDto[]; total: number; pages: number; } | Promise<{ data: OrderDto[]; total: number; pages: number; }>'.

    [7m182[0m       orderService.findAll.mockResolvedValue(orders);
    [7m   [0m [91m                                             ~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m185[0m:[93m47[0m - [91merror[0m[90m TS2345: [0mArgument of type 'QueryOrderDto' is not assignable to parameter of type 'number'.

    [7m185[0m       const result = await controller.findAll(queryDto);
    [7m   [0m [91m                                              ~~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m197[0m:[93m46[0m - [91merror[0m[90m TS2345: [0mArgument of type 'OrderDto[]' is not assignable to parameter of type '{ data: OrderDto[]; total: number; pages: number; } | Promise<{ data: OrderDto[]; total: number; pages: number; }>'.

    [7m197[0m       orderService.findAll.mockResolvedValue(orders);
    [7m   [0m [91m                                             ~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m200[0m:[93m47[0m - [91merror[0m[90m TS2345: [0mArgument of type 'QueryOrderDto' is not assignable to parameter of type 'number'.

    [7m200[0m       const result = await controller.findAll(emptyQuery);
    [7m   [0m [91m                                              ~~~~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m215[0m:[93m47[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m215[0m       const result = await controller.findOne(orderId);
    [7m   [0m [91m                                              ~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m231[0m:[93m39[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m231[0m       await expect(controller.findOne(orderId)).rejects.toThrow(
    [7m   [0m [91m                                      ~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m262[0m:[93m54[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m262[0m       const result = await controller.findByCustomer(customerId);
    [7m   [0m [91m                                                     ~~~~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m279[0m:[93m52[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m279[0m       const result = await controller.findByFitter(fitterId);
    [7m   [0m [91m                                                   ~~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m296[0m:[93m53[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m296[0m       const result = await controller.findByFactory(factoryId);
    [7m   [0m [91m                                                    ~~~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m437[0m:[93m58[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m437[0m       const result = await controller.getCustomerSummary(customerId);
    [7m   [0m [91m                                                         ~~~~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m457[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m457[0m         fitterId: "new-fitter-id",
    [7m   [0m [91m        ~~~~~~~~[0m

      [96msrc/orders/dto/update-order.dto.ts[0m:[93m66[0m:[93m3[0m
        [7m66[0m   fitterId?: number;
        [7m  [0m [96m  ~~~~~~~~[0m
        The expected type comes from property 'fitterId' which is declared here on type 'UpdateOrderDto'
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m458[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m458[0m         factoryId: "new-supplier-id",
    [7m   [0m [91m        ~~~~~~~~~[0m

      [96msrc/orders/dto/update-order.dto.ts[0m:[93m75[0m:[93m3[0m
        [7m75[0m   factoryId?: number;
        [7m  [0m [96m  ~~~~~~~~~[0m
        The expected type comes from property 'factoryId' which is declared here on type 'UpdateOrderDto'
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m471[0m:[93m46[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m471[0m       const result = await controller.update(orderId, updateDto);
    [7m   [0m [91m                                             ~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m490[0m:[93m46[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m490[0m       const result = await controller.update(orderId, updateDto);
    [7m   [0m [91m                                             ~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m507[0m:[93m46[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m507[0m       const result = await controller.cancel(orderId, reason);
    [7m   [0m [91m                                             ~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m524[0m:[93m38[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m524[0m       await expect(controller.cancel(orderId, reason)).rejects.toThrow(
    [7m   [0m [91m                                     ~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m538[0m:[93m31[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m538[0m       await controller.remove(orderId);
    [7m   [0m [91m                              ~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m553[0m:[93m38[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m553[0m       await expect(controller.remove(orderId)).rejects.toThrow(
    [7m   [0m [91m                                     ~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m569[0m:[93m39[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m569[0m       await expect(controller.findOne(orderId)).rejects.toThrow(
    [7m   [0m [91m                                      ~~~~~~~[0m
    [96mtest/unit/orders/order.controller.spec.ts[0m:[93m593[0m:[93m54[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m593[0m       const result = await controller.findByCustomer(customerId);
    [7m   [0m [91m                                                     ~~~~~~~~~~[0m

PASS test/unit/behaviors/blameable-behavior.service.spec.ts (24.815 s)
FAIL test/unit/orders/order.service.spec.ts
  ‚óè Test suite failed to run

    [96mtest/unit/orders/order.service.spec.ts[0m:[93m159[0m:[93m14[0m - [91merror[0m[90m TS2339: [0mProperty 'generate' does not exist on type 'typeof OrderId'.

    [7m159[0m     (OrderId.generate as jest.Mock).mockReturnValue(mockOrderId);
    [7m   [0m [91m             ~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m162[0m:[93m39[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; orderNumber: string; customerId: string; fitterId: string; factoryId: string; status: string; priority: string; totalAmount: number; paidAmount: number; remainingAmount: number; saddleSpecifications: { ...; }; ... 15 more ...; updatedAt: Date; }' is not assignable to parameter of type 'OrderDto'.
      Types of property 'id' are incompatible.
        Type 'string' is not assignable to type 'number'.

    [7m162[0m     orderMapper.toDto.mockReturnValue(mockOrderDto);
    [7m   [0m [91m                                      ~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m174[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m174[0m         customerId: "123e4567-e89b-12d3-a456-426614174000",
    [7m   [0m [91m        ~~~~~~~~~~[0m

      [96msrc/orders/dto/create-order.dto.ts[0m:[93m57[0m:[93m3[0m
        [7m57[0m   customerId?: number;
        [7m  [0m [96m  ~~~~~~~~~~[0m
        The expected type comes from property 'customerId' which is declared here on type 'CreateOrderDto'
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m184[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m184[0m         fitterId: "789e0123-e45b-67c8-d901-234567890abc",
    [7m   [0m [91m        ~~~~~~~~[0m

      [96msrc/orders/dto/create-order.dto.ts[0m:[93m25[0m:[93m3[0m
        [7m25[0m   fitterId?: number;
        [7m  [0m [96m  ~~~~~~~~[0m
        The expected type comes from property 'fitterId' which is declared here on type 'CreateOrderDto'
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m185[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m185[0m         factoryId: "456e7890-b12c-34d5-e678-901234567def",
    [7m   [0m [91m        ~~~~~~~~~[0m

      [96msrc/orders/dto/create-order.dto.ts[0m:[93m49[0m:[93m3[0m
        [7m49[0m   factoryId?: number;
        [7m  [0m [96m  ~~~~~~~~~[0m
        The expected type comes from property 'factoryId' which is declared here on type 'CreateOrderDto'
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m205[0m:[93m19[0m - [91merror[0m[90m TS2339: [0mProperty 'orderNumber' does not exist on type 'CreateOrderDto'.

    [7m205[0m         createDto.orderNumber,
    [7m   [0m [91m                  ~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m207[0m:[93m22[0m - [91merror[0m[90m TS2339: [0mProperty 'generate' does not exist on type 'typeof OrderId'.

    [7m207[0m       expect(OrderId.generate).toHaveBeenCalled();
    [7m   [0m [91m                     ~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m211[0m:[93m19[0m - [91merror[0m[90m TS2339: [0mProperty 'orderNumber' does not exist on type 'CreateOrderDto'.

    [7m211[0m         createDto.orderNumber,
    [7m   [0m [91m                  ~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m212[0m:[93m19[0m - [91merror[0m[90m TS2339: [0mProperty 'saddleSpecifications' does not exist on type 'CreateOrderDto'.

    [7m212[0m         createDto.saddleSpecifications,
    [7m   [0m [91m                  ~~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m213[0m:[93m19[0m - [91merror[0m[90m TS2339: [0mProperty 'totalAmount' does not exist on type 'CreateOrderDto'.

    [7m213[0m         createDto.totalAmount,
    [7m   [0m [91m                  ~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m214[0m:[93m19[0m - [91merror[0m[90m TS2339: [0mProperty 'specialInstructions' does not exist on type 'CreateOrderDto'.

    [7m214[0m         createDto.specialInstructions,
    [7m   [0m [91m                  ~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m215[0m:[93m19[0m - [91merror[0m[90m TS2339: [0mProperty 'estimatedDeliveryDate' does not exist on type 'CreateOrderDto'.

    [7m215[0m         createDto.estimatedDeliveryDate,
    [7m   [0m [91m                  ~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m226[0m:[93m19[0m - [91merror[0m[90m TS2339: [0mProperty 'initialDeposit' does not exist on type 'CreateOrderDto'.

    [7m226[0m         createDto.initialDeposit,
    [7m   [0m [91m                  ~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m229[0m:[93m19[0m - [91merror[0m[90m TS2339: [0mProperty 'measurements' does not exist on type 'CreateOrderDto'.

    [7m229[0m         createDto.measurements,
    [7m   [0m [91m                  ~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m240[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m240[0m         customerId: "123e4567-e89b-12d3-a456-426614174000",
    [7m   [0m [91m        ~~~~~~~~~~[0m

      [96msrc/orders/dto/create-order.dto.ts[0m:[93m57[0m:[93m3[0m
        [7m57[0m   customerId?: number;
        [7m  [0m [96m  ~~~~~~~~~~[0m
        The expected type comes from property 'customerId' which is declared here on type 'CreateOrderDto'
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m259[0m:[93m26[0m - [91merror[0m[90m TS2339: [0mProperty 'orderNumber' does not exist on type 'CreateOrderDto'.

    [7m259[0m         minimalCreateDto.orderNumber,
    [7m   [0m [91m                         ~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m260[0m:[93m26[0m - [91merror[0m[90m TS2339: [0mProperty 'saddleSpecifications' does not exist on type 'CreateOrderDto'.

    [7m260[0m         minimalCreateDto.saddleSpecifications,
    [7m   [0m [91m                         ~~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m261[0m:[93m26[0m - [91merror[0m[90m TS2339: [0mProperty 'totalAmount' does not exist on type 'CreateOrderDto'.

    [7m261[0m         minimalCreateDto.totalAmount,
    [7m   [0m [91m                         ~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m262[0m:[93m26[0m - [91merror[0m[90m TS2339: [0mProperty 'specialInstructions' does not exist on type 'CreateOrderDto'.

    [7m262[0m         minimalCreateDto.specialInstructions,
    [7m   [0m [91m                         ~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m263[0m:[93m26[0m - [91merror[0m[90m TS2339: [0mProperty 'estimatedDeliveryDate' does not exist on type 'CreateOrderDto'.

    [7m263[0m         minimalCreateDto.estimatedDeliveryDate,
    [7m   [0m [91m                         ~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m276[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m276[0m         customerId: "123e4567-e89b-12d3-a456-426614174000",
    [7m   [0m [91m        ~~~~~~~~~~[0m

      [96msrc/orders/dto/create-order.dto.ts[0m:[93m57[0m:[93m3[0m
        [7m57[0m   customerId?: number;
        [7m  [0m [96m  ~~~~~~~~~~[0m
        The expected type comes from property 'customerId' which is declared here on type 'CreateOrderDto'
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m289[0m:[93m19[0m - [91merror[0m[90m TS2339: [0mProperty 'orderNumber' does not exist on type 'CreateOrderDto'.

    [7m289[0m         createDto.orderNumber,
    [7m   [0m [91m                  ~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m299[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m299[0m         customerId: "123e4567-e89b-12d3-a456-426614174000",
    [7m   [0m [91m        ~~~~~~~~~~[0m

      [96msrc/orders/dto/create-order.dto.ts[0m:[93m57[0m:[93m3[0m
        [7m57[0m   customerId?: number;
        [7m  [0m [96m  ~~~~~~~~~~[0m
        The expected type comes from property 'customerId' which is declared here on type 'CreateOrderDto'
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m328[0m:[93m44[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m328[0m       const result = await service.findOne(orderId);
    [7m   [0m [91m                                           ~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m343[0m:[93m36[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m343[0m       await expect(service.findOne(orderId)).rejects.toThrow(NotFoundException);
    [7m   [0m [91m                                   ~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m401[0m:[93m44[0m - [91merror[0m[90m TS2345: [0mArgument of type 'QueryOrderDto' is not assignable to parameter of type 'number'.

    [7m401[0m       const result = await service.findAll(queryDto);
    [7m   [0m [91m                                           ~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m426[0m:[93m44[0m - [91merror[0m[90m TS2345: [0mArgument of type 'QueryOrderDto' is not assignable to parameter of type 'number'.

    [7m426[0m       const result = await service.findAll(queryDto);
    [7m   [0m [91m                                           ~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m445[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m445[0m         fitterId: "new-fitter-id",
    [7m   [0m [91m        ~~~~~~~~[0m

      [96msrc/orders/dto/update-order.dto.ts[0m:[93m66[0m:[93m3[0m
        [7m66[0m   fitterId?: number;
        [7m  [0m [96m  ~~~~~~~~[0m
        The expected type comes from property 'fitterId' which is declared here on type 'UpdateOrderDto'
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m446[0m:[93m9[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m446[0m         factoryId: "new-supplier-id",
    [7m   [0m [91m        ~~~~~~~~~[0m

      [96msrc/orders/dto/update-order.dto.ts[0m:[93m75[0m:[93m3[0m
        [7m75[0m   factoryId?: number;
        [7m  [0m [96m  ~~~~~~~~~[0m
        The expected type comes from property 'factoryId' which is declared here on type 'UpdateOrderDto'
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m465[0m:[93m43[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m465[0m       const result = await service.update(orderId, updateDto);
    [7m   [0m [91m                                          ~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m507[0m:[93m43[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m507[0m       const result = await service.update(orderId, updateDto);
    [7m   [0m [91m                                          ~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m530[0m:[93m35[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m530[0m       await expect(service.update(orderId, updateDto)).rejects.toThrow(
    [7m   [0m [91m                                  ~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m548[0m:[93m28[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m548[0m       await service.update(orderId, updateDto);
    [7m   [0m [91m                           ~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m564[0m:[93m43[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m564[0m       const result = await service.cancel(orderId, reason);
    [7m   [0m [91m                                          ~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m581[0m:[93m35[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m581[0m       await expect(service.cancel(orderId, reason)).rejects.toThrow(
    [7m   [0m [91m                                  ~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m595[0m:[93m35[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m595[0m       await expect(service.cancel(orderId, reason)).rejects.toThrow(
    [7m   [0m [91m                                  ~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m608[0m:[93m35[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m608[0m       await expect(service.cancel(orderId, reason)).rejects.toThrow(
    [7m   [0m [91m                                  ~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m623[0m:[93m28[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m623[0m       await service.remove(orderId);
    [7m   [0m [91m                           ~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m636[0m:[93m35[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m636[0m       await expect(service.remove(orderId)).rejects.toThrow(NotFoundException);
    [7m   [0m [91m                                  ~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m650[0m:[93m53[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m650[0m       const result = await service.findByCustomerId(customerId);
    [7m   [0m [91m                                                    ~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m664[0m:[93m51[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m664[0m       const result = await service.findByFitterId(fitterId);
    [7m   [0m [91m                                                  ~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m678[0m:[93m52[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m678[0m       const result = await service.findByFactoryId(factoryId);
    [7m   [0m [91m                                                   ~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m692[0m:[93m52[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m692[0m       const result = await service.findByFactoryId(factoryId);
    [7m   [0m [91m                                                   ~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m827[0m:[93m60[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m827[0m       const result = await service.getCustomerOrderSummary(customerId);
    [7m   [0m [91m                                                           ~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m885[0m:[93m36[0m - [91merror[0m[90m TS2345: [0mArgument of type 'string' is not assignable to parameter of type 'number'.

    [7m885[0m       await expect(service.findOne(orderId)).rejects.toThrow(
    [7m   [0m [91m                                   ~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m897[0m:[93m25[0m - [91merror[0m[90m TS2339: [0mProperty 'findByLegacyId' does not exist on type 'Mocked<IOrderRepository>'.

    [7m897[0m         orderRepository.findByLegacyId.mockResolvedValue(mockOrder);
    [7m   [0m [91m                        ~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m900[0m:[93m38[0m - [91merror[0m[90m TS2339: [0mProperty 'findByLegacyId' does not exist on type 'OrderService'.

    [7m900[0m         const result = await service.findByLegacyId(legacyId);
    [7m   [0m [91m                                     ~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m904[0m:[93m32[0m - [91merror[0m[90m TS2339: [0mProperty 'findByLegacyId' does not exist on type 'Mocked<IOrderRepository>'.

    [7m904[0m         expect(orderRepository.findByLegacyId).toHaveBeenCalledWith(legacyId);
    [7m   [0m [91m                               ~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m911[0m:[93m25[0m - [91merror[0m[90m TS2339: [0mProperty 'findByLegacyId' does not exist on type 'Mocked<IOrderRepository>'.

    [7m911[0m         orderRepository.findByLegacyId.mockResolvedValue(null);
    [7m   [0m [91m                        ~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m914[0m:[93m38[0m - [91merror[0m[90m TS2339: [0mProperty 'findByLegacyId' does not exist on type 'OrderService'.

    [7m914[0m         const result = await service.findByLegacyId(legacyId);
    [7m   [0m [91m                                     ~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m918[0m:[93m32[0m - [91merror[0m[90m TS2339: [0mProperty 'findByLegacyId' does not exist on type 'Mocked<IOrderRepository>'.

    [7m918[0m         expect(orderRepository.findByLegacyId).toHaveBeenCalledWith(legacyId);
    [7m   [0m [91m                               ~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m935[0m:[93m38[0m - [91merror[0m[90m TS2339: [0mProperty 'findProductionOrders' does not exist on type 'OrderService'.

    [7m935[0m         const result = await service.findProductionOrders();
    [7m   [0m [91m                                     ~~~~~~~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m950[0m:[93m13[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m950[0m             customerId: "123e4567-e89b-12d3-a456-426614174000",
    [7m   [0m [91m            ~~~~~~~~~~[0m

      [96msrc/orders/dto/create-order.dto.ts[0m:[93m57[0m:[93m3[0m
        [7m57[0m   customerId?: number;
        [7m  [0m [96m  ~~~~~~~~~~[0m
        The expected type comes from property 'customerId' which is declared here on type 'CreateOrderDto'
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m957[0m:[93m13[0m - [91merror[0m[90m TS2322: [0mType 'string' is not assignable to type 'number'.

    [7m957[0m             customerId: "123e4567-e89b-12d3-a456-426614174001",
    [7m   [0m [91m            ~~~~~~~~~~[0m

      [96msrc/orders/dto/create-order.dto.ts[0m:[93m57[0m:[93m3[0m
        [7m57[0m   customerId?: number;
        [7m  [0m [96m  ~~~~~~~~~~[0m
        The expected type comes from property 'customerId' which is declared here on type 'CreateOrderDto'
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m971[0m:[93m38[0m - [91merror[0m[90m TS2339: [0mProperty 'bulkCreate' does not exist on type 'OrderService'.

    [7m971[0m         const result = await service.bulkCreate(createDtos);
    [7m   [0m [91m                                     ~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m1000[0m:[93m38[0m - [91merror[0m[90m TS2339: [0mProperty 'updateSeatSizes' does not exist on type 'OrderService'.

    [7m1000[0m         const result = await service.updateSeatSizes(orderId, seatSizes);
    [7m    [0m [91m                                     ~~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m1022[0m:[93m19[0m - [91merror[0m[90m TS2339: [0mProperty 'updateSeatSizes' does not exist on type 'OrderService'.

    [7m1022[0m           service.updateSeatSizes(orderId, seatSizes),
    [7m    [0m [91m                  ~~~~~~~~~~~~~~~[0m
    [96mtest/unit/orders/order.service.spec.ts[0m:[93m1042[0m:[93m38[0m - [91merror[0m[90m TS2339: [0mProperty 'getSeatSizeSummary' does not exist on type 'OrderService'.

    [7m1042[0m         const result = await service.getSeatSizeSummary();
    [7m    [0m [91m                                     ~~~~~~~~~~~~~~~~~~[0m

[31m[Nest] 24753  - [39m01/14/2026, 10:38:06 AM [31m  ERROR[39m [38;5;3m[BehaviorManager] [39m[31mFailed to apply TimestampableBehavior beforeSave[39m
[31m[Nest] 24753  - [39m01/14/2026, 10:38:06 AM [31m  ERROR[39m [38;5;3m[BehaviorManager] [39mError: Behavior failed
    at Object.<anonymous> [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mtest/unit/behaviors/behavior-manager.service.spec.ts:164:21[90m)[39m
    at Promise.finally.completed [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1556:28[90m)[39m
    at new Promise (<anonymous>)
    at callAsyncCircusFn [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1496:10[90m)[39m
    at _callCircusTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1006:40[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at _runTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:946:3[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:839:13[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:829:11[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:829:11[90m)[39m
    at run [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:757:3[90m)[39m
    at runAndTransformResultsToJestFormat [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1917:21[90m)[39m
    at jestAdapter [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/runner.js:101:19[90m)[39m
    at runTestInternal [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:275:16[90m)[39m
    at runTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:343:7[90m)[39m
    at Object.worker [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:497:12[90m)[39m
[31m[Nest] 24753  - [39m01/14/2026, 10:38:06 AM [31m  ERROR[39m [38;5;3m[BehaviorManager] [39m[31mFailed to apply TimestampableBehavior afterSave[39m
[31m[Nest] 24753  - [39m01/14/2026, 10:38:06 AM [31m  ERROR[39m [38;5;3m[BehaviorManager] [39mError: After save behavior failed
    at Object.<anonymous> [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mtest/unit/behaviors/behavior-manager.service.spec.ts:217:21[90m)[39m
    at Promise.finally.completed [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1556:28[90m)[39m
    at new Promise (<anonymous>)
    at callAsyncCircusFn [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1496:10[90m)[39m
    at _callCircusTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1006:40[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at _runTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:946:3[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:839:13[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:829:11[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:829:11[90m)[39m
    at run [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:757:3[90m)[39m
    at runAndTransformResultsToJestFormat [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1917:21[90m)[39m
    at jestAdapter [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/runner.js:101:19[90m)[39m
    at runTestInternal [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:275:16[90m)[39m
    at runTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:343:7[90m)[39m
    at Object.worker [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:497:12[90m)[39m
[31m[Nest] 24753  - [39m01/14/2026, 10:38:06 AM [31m  ERROR[39m [38;5;3m[BehaviorManager] [39m[31mFailed to apply SoftDeletableBehavior beforeDelete[39m
[31m[Nest] 24753  - [39m01/14/2026, 10:38:06 AM [31m  ERROR[39m [38;5;3m[BehaviorManager] [39mError: Before delete failed
    at Object.<anonymous> [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mtest/unit/behaviors/behavior-manager.service.spec.ts:264:21[90m)[39m
    at Promise.finally.completed [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1556:28[90m)[39m
    at new Promise (<anonymous>)
    at callAsyncCircusFn [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1496:10[90m)[39m
    at _callCircusTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1006:40[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at _runTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:946:3[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:839:13[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:829:11[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:829:11[90m)[39m
    at run [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:757:3[90m)[39m
    at runAndTransformResultsToJestFormat [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1917:21[90m)[39m
    at jestAdapter [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/runner.js:101:19[90m)[39m
    at runTestInternal [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:275:16[90m)[39m
    at runTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:343:7[90m)[39m
    at Object.worker [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:497:12[90m)[39m
[31m[Nest] 24753  - [39m01/14/2026, 10:38:06 AM [31m  ERROR[39m [38;5;3m[BehaviorManager] [39m[31mFailed to apply SoftDeletableBehavior afterDelete[39m
[31m[Nest] 24753  - [39m01/14/2026, 10:38:06 AM [31m  ERROR[39m [38;5;3m[BehaviorManager] [39mError: After delete behavior failed
    at Object.<anonymous> [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mtest/unit/behaviors/behavior-manager.service.spec.ts:295:21[90m)[39m
    at Promise.finally.completed [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1556:28[90m)[39m
    at new Promise (<anonymous>)
    at callAsyncCircusFn [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1496:10[90m)[39m
    at _callCircusTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1006:40[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at _runTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:946:3[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:839:13[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:829:11[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:829:11[90m)[39m
    at run [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:757:3[90m)[39m
    at runAndTransformResultsToJestFormat [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1917:21[90m)[39m
    at jestAdapter [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/runner.js:101:19[90m)[39m
    at runTestInternal [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:275:16[90m)[39m
    at runTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:343:7[90m)[39m
    at Object.worker [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:497:12[90m)[39m
[31m[Nest] 24753  - [39m01/14/2026, 10:38:06 AM [31m  ERROR[39m [38;5;3m[BehaviorManager] [39m[31mFailed to apply TimestampableBehavior onLoad[39m
[31m[Nest] 24753  - [39m01/14/2026, 10:38:06 AM [31m  ERROR[39m [38;5;3m[BehaviorManager] [39mError: On load behavior failed
    at Object.<anonymous> [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mtest/unit/behaviors/behavior-manager.service.spec.ts:334:21[90m)[39m
    at Promise.finally.completed [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1556:28[90m)[39m
    at new Promise (<anonymous>)
    at callAsyncCircusFn [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1496:10[90m)[39m
    at _callCircusTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1006:40[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at _runTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:946:3[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:839:13[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:829:11[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:829:11[90m)[39m
    at run [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:757:3[90m)[39m
    at runAndTransformResultsToJestFormat [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1917:21[90m)[39m
    at jestAdapter [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/runner.js:101:19[90m)[39m
    at runTestInternal [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:275:16[90m)[39m
    at runTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:343:7[90m)[39m
    at Object.worker [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:497:12[90m)[39m
[31m[Nest] 24753  - [39m01/14/2026, 10:38:06 AM [31m  ERROR[39m [38;5;3m[BehaviorManager] [39m[31mFailed to apply TimestampableBehavior afterSave[39m
[31m[Nest] 24753  - [39m01/14/2026, 10:38:06 AM [31m  ERROR[39m [38;5;3m[BehaviorManager] [39mError: Phase-specific error
    at Object.<anonymous> [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mtest/unit/behaviors/behavior-manager.service.spec.ts:560:21[90m)[39m
    at Promise.finally.completed [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1556:28[90m)[39m
    at new Promise (<anonymous>)
    at callAsyncCircusFn [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1496:10[90m)[39m
    at _callCircusTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1006:40[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at _runTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:946:3[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:839:13[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:829:11[90m)[39m
    at _runTestsForDescribeBlock [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:829:11[90m)[39m
    at run [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:757:3[90m)[39m
    at runAndTransformResultsToJestFormat [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/jestAdapterInit.js:1917:21[90m)[39m
    at jestAdapter [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-circus[24m/build/runner.js:101:19[90m)[39m
    at runTestInternal [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:275:16[90m)[39m
    at runTest [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:343:7[90m)[39m
    at Object.worker [90m(/Users/in615bac/Library/CloudStorage/ProtonDrive-elky.bachtiar@protonmail.com-folder/OMS_NEXT/oms_nest/backend/[39mnode_modules/[4mjest-runner[24m/build/testWorker.js:497:12[90m)[39m
PASS test/unit/behaviors/behavior-manager.service.spec.ts (25.477 s)
PASS test/unit/simple-validation.spec.ts (25.79 s)
PASS test/unit/auth/auth.service.spec.ts (26.798 s)
FAIL test/unit/rls/rls.service.spec.ts (26.607 s)
  ‚óè RlsService ‚Ä∫ checkRlsStatus ‚Ä∫ should return RLS status for all tables

    expect(received).toMatchObject(expected)

    - Expected  - 1
    + Received  + 1

      Object {
        "policies": Array [
          "user_policy",
        ],
        "rlsEnabled": true,
    -   "table": "user",
    +   "table": "credentials",
      }

      200 |
      201 |       expect(status).toHaveLength(7); // Should check 7 tables
    > 202 |       expect(status[0]).toMatchObject({
          |                         ^
      203 |         table: "user",
      204 |         rlsEnabled: true,
      205 |         policies: ["user_policy"],

      at Object.<anonymous> (test/unit/rls/rls.service.spec.ts:202:25)

  ‚óè RlsService ‚Ä∫ testRlsPolicies ‚Ä∫ should test access to all tables with given user context

    expect(received).toMatchObject(expected)

    - Expected  - 1
    + Received  + 1

      Object {
        "accessibleRecords": 5,
    -   "table": "user",
    +   "table": "credentials",
      }

      221 |
      222 |       expect(results).toHaveLength(7); // Should test 7 tables
    > 223 |       expect(results[0]).toMatchObject({
          |                          ^
      224 |         table: "user",
      225 |         accessibleRecords: 5,
      226 |       });

      at Object.<anonymous> (test/unit/rls/rls.service.spec.ts:223:26)

  ‚óè RlsService ‚Ä∫ testRlsPolicies ‚Ä∫ should handle query errors gracefully

    expect(received).toMatchObject(expected)

    - Expected  - 1
    + Received  + 1

      Object {
        "accessibleRecords": 0,
        "error": "Access denied",
    -   "table": "user",
    +   "table": "credentials",
      }

      235 |       const results = await service.testRlsPolicies("test-user", RoleEnum.user);
      236 |
    > 237 |       expect(results[0]).toMatchObject({
          |                          ^
      238 |         table: "user",
      239 |         accessibleRecords: 0,
      240 |         error: "Access denied",

      at Object.<anonymous> (test/unit/rls/rls.service.spec.ts:237:26)

PASS test/unit/enriched-orders/enriched-orders.service.spec.ts (27.156 s)
FAIL test/unit/brands/brand.service.spec.ts
  ‚óè BrandService ‚Ä∫ findOne ‚Ä∫ should find brand by UUID

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 101

    Number of calls: 0

      142 |       // Assert
      143 |       expect(result).toEqual(mockBrandDto);
    > 144 |       expect(BrandEntity.createFindOptions).toHaveBeenCalledWith(brandId);
          |                                             ^
      145 |       expect(repository.findOne).toHaveBeenCalledWith({
      146 |         where: { id: brandId, deletedAt: IsNull() },
      147 |       });

      at Object.<anonymous> (test/unit/brands/brand.service.spec.ts:144:45)

  ‚óè BrandService ‚Ä∫ findOne ‚Ä∫ should find brand by legacy ID

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 101

    Number of calls: 0

      159 |       // Assert
      160 |       expect(result).toEqual(mockBrandDto);
    > 161 |       expect(BrandEntity.createFindOptions).toHaveBeenCalledWith(legacyId);
          |                                             ^
      162 |       expect(repository.findOne).toHaveBeenCalledWith({
      163 |         where: { legacyId, deletedAt: IsNull() },
      164 |       });

      at Object.<anonymous> (test/unit/brands/brand.service.spec.ts:161:45)

  ‚óè BrandService ‚Ä∫ remove ‚Ä∫ should soft delete brand successfully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

    @@ -7,8 +7,8 @@
            "_objectLiteralParameters": undefined,
            "_type": "isNull",
            "_useParameter": false,
            "_value": undefined,
          },
    -     "legacyId": 101,
    +     "id": 101,
        },
      },

    Number of calls: 1

      318 |
      319 |       // Assert
    > 320 |       expect(repository.findOne).toHaveBeenCalledWith({
          |                                  ^
      321 |         where: { legacyId: brandId, deletedAt: IsNull() },
      322 |       });
      323 |       expect(repository.save).toHaveBeenCalledWith(

      at Object.<anonymous> (test/unit/brands/brand.service.spec.ts:320:34)

  ‚óè BrandService ‚Ä∫ remove ‚Ä∫ should handle legacy ID deletion

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

    @@ -7,8 +7,8 @@
            "_objectLiteralParameters": undefined,
            "_type": "isNull",
            "_useParameter": false,
            "_value": undefined,
          },
    -     "legacyId": 101,
    +     "id": 101,
        },
      },

    Number of calls: 1

      340 |
      341 |       // Assert
    > 342 |       expect(repository.findOne).toHaveBeenCalledWith({
          |                                  ^
      343 |         where: { legacyId, deletedAt: IsNull() },
      344 |       });
      345 |       expect(repository.save).toHaveBeenCalledWith(

      at Object.<anonymous> (test/unit/brands/brand.service.spec.ts:342:34)

PASS test/unit/customers/customer.controller.spec.ts (27.796 s)
PASS test/unit/auth/auth.controller.spec.ts

Test Suites: 6 failed, 7 passed, 13 total
Tests:       7 failed, 159 passed, 166 total
Snapshots:   0 total
Time:        31.094 s, estimated 32 s
Ran all test suites.
